# Настройка личного кабинета пользователя

## Что было создано

### Фронтенд:
1. ✅ Система аутентификации (регистрация, вход, выход)
2. ✅ Страница профиля пользователя
3. ✅ Функционал избранного (добавление/удаление спектаклей)
4. ✅ Система рецензий (создание, просмотр, лайки)
5. ✅ Интеграция кнопок на странице спектакля

### Файлы:
- `src/contexts/AuthContext.js` - контекст аутентификации
- `src/api/user.js` - API функции для работы с пользователями, избранным и рецензиями
- `src/pages/Login.jsx` - страница входа
- `src/pages/Register.jsx` - страница регистрации
- `src/pages/Profile.jsx` - страница профиля
- `src/pages/Reviews.jsx` - страница с рецензиями
- `src/components/CreateReviewModal.jsx` - модальное окно создания рецензии
- Стили для всех новых компонентов

## Настройка Strapi

### 1. Добавление полей в User

1. Зайдите в Strapi Admin Panel
2. Перейдите в **Content-Type Builder**
3. Найдите **User** (в разделе Users & Permissions Plugin)
4. Добавьте поля:
   - `firstName` (Text)
   - `lastName` (Text)
   - `bio` (Rich Text или Text)
   - `avatar` (Media - Single)
   - `favorites` (Relation - Many-to-Many с Performance)

### 2. Создание Content Type для рецензий

1. В **Content-Type Builder** создайте новый Collection Type:
   - Display name: `Review`
   - API ID: `review`

2. Добавьте поля:
   - `title` (Text) - обязательное
   - `text` (Rich Text) - обязательное
   - `rating` (Number) - опциональное
   - `performance` (Relation - Many-to-One с Performance) - обязательное
   - `user` (Relation - Many-to-One с User) - обязательное
   - `likes` (Relation - Many-to-Many с User) - для лайков

### 3. Настройка прав доступа

#### Для Users (роль Authenticated):
- `find` - найти пользователей
- `findOne` - найти одного пользователя
- `update` - обновить свой профиль
- `me` - получить свои данные

#### Для Reviews (роль Authenticated):
- `find` - найти рецензии
- `findOne` - найти одну рецензию
- `create` - создать рецензию
- `update` - обновить свою рецензию
- `delete` - удалить свою рецензию

#### Для Reviews (роль Public):
- `find` - найти рецензии
- `findOne` - найти одну рецензию

#### Для Performance (роль Public):
- `find` - найти спектакли
- `findOne` - найти один спектакль

## Использование

### Регистрация и вход:
- `/register` - страница регистрации
- `/login` - страница входа
- В Header появляется ссылка "Профиль" для авторизованных пользователей

### Профиль:
- `/profile` - страница профиля пользователя
- Показывает: личную информацию, избранные спектакли, рецензии пользователя
- Можно редактировать: имя, фамилию, БИО

### Избранное:
- На странице спектакля кнопка "В избранное" / "В избранном"
- При клике добавляет/удаляет спектакль из избранного
- Требует авторизации

### Рецензии:
- На странице спектакля кнопки:
  - "Создать рецензию" - открывает модальное окно (требует авторизации)
  - "Посмотреть рецензии (N)" - переходит на страницу со всеми рецензиями
- На странице рецензий:
  - Список всех рецензий на спектакль
  - Имя автора (кликабельное, ведет на профиль)
  - Название и текст рецензии
  - Кнопка лайка (требует авторизации)

## Важно

После настройки Content Types в Strapi:
1. Перезапустите Strapi сервер
2. Проверьте права доступа в Settings → Users & Permissions
3. Создайте тестового пользователя через регистрацию на сайте

## Примечания

- Все данные хранятся в Strapi
- Токены авторизации хранятся в localStorage
- При выходе токен удаляется
- Избранное и рецензии привязаны к пользователю

